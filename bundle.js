/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";function t(){var r,n,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.toStringTag||"@@toStringTag";function c(t,o,i,a){var c=o&&o.prototype instanceof s?o:s,l=Object.create(c.prototype);return e(l,"_invoke",function(t,e,o){var i,a,c,s=0,l=o||[],f=!1,p={p:0,n:0,v:r,a:v,f:v.bind(r,4),d:function(t,e){return i=t,a=0,c=r,p.n=e,u}};function v(t,e){for(a=t,c=e,n=0;!f&&s&&!o&&n<l.length;n++){var o,i=l[n],v=p.p,y=i[2];t>3?(o=y===e)&&(a=i[4]||3,c=i[5]===r?i[3]:i[5],i[4]=3,i[5]=r):i[0]<=v&&((o=t<2&&v<i[1])?(a=0,p.v=e,p.n=i[1]):v<y&&(o=t<3||i[0]>e||e>y)&&(i[4]=t,i[5]=e,p.n=y,a=0))}if(o||t>1)return u;throw f=!0,e}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&v(l,y),a=l,c=y;(n=a<2?r:c)||!f;){i||(a?a<3?(a>1&&(p.n=-1),v(a,c)):p.n=c:p.v=c);try{if(s=2,i){if(a||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,a<2&&(a=0)}else 1===a&&(n=i.return)&&n.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=r}else if((n=(f=p.n<0)?c:t.call(e,p))!==u)break}catch(t){i=r,a=1,c=t}finally{s=1}}return{value:n,done:f}}}(t,i,a),!0),l}var u={};function s(){}function l(){}function f(){}n=Object.getPrototypeOf;var p=[][i]?n(n([][i]())):(e(n={},i,(function(){return this})),n),v=f.prototype=s.prototype=Object.create(p);function y(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,e(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t}return l.prototype=f,e(v,"constructor",f),e(f,"constructor",l),l.displayName="GeneratorFunction",e(f,a,"GeneratorFunction"),e(v),e(v,a,"Generator"),e(v,i,(function(){return this})),e(v,"toString",(function(){return"[object Generator]"})),(t=function(){return{w:c,m:y}})()}function e(t,r,n,o){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}e=function(t,r,n,o){if(r)i?i(t,r,{value:n,enumerable:!o,configurable:!o,writable:!o}):t[r]=n;else{var a=function(r,n){e(t,r,(function(t){return this._invoke(r,n,t)}))};a("next",0),a("throw",1),a("return",2)}},e(t,r,n,o)}function r(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function n(t){return function(){var e=this,n=arguments;return new Promise((function(o,i){var a=t.apply(e,n);function c(t){r(a,o,i,c,u,"next",t)}function u(t){r(a,o,i,c,u,"throw",t)}c(void 0)}))}}var o="https://story-api.dicoding.dev/v1";function i(){var t=localStorage.getItem("token");if(!t)throw new Error("User belum login");return t}function a(){return c.apply(this,arguments)}function c(){return(c=n(t().m((function e(){var r,n,a;return t().w((function(t){for(;;)switch(t.n){case 0:return r=i(),t.n=1,fetch("".concat(o,"/stories"),{headers:{Authorization:"Bearer ".concat(r)}});case 1:return n=t.v,t.n=2,n.json();case 2:if(a=t.v,n.ok){t.n=3;break}throw new Error(a.message||"Gagal ambil data story");case 3:return t.a(2,a.listStory||[])}}),e)})))).apply(this,arguments)}function u(t){return s.apply(this,arguments)}function s(){return(s=n(t().m((function e(r){var n,a,c;return t().w((function(t){for(;;)switch(t.n){case 0:return n=i(),t.n=1,fetch("".concat(o,"/stories/").concat(r),{headers:{Authorization:"Bearer ".concat(n)}});case 1:return a=t.v,t.n=2,a.json();case 2:if(c=t.v,a.ok){t.n=3;break}throw new Error(c.message||"Gagal ambil detail story");case 3:return t.a(2,c.story)}}),e)})))).apply(this,arguments)}function l(t){return f.apply(this,arguments)}function f(){return(f=n(t().m((function e(r){var n,a,c,u,s,l,f,p;return t().w((function(t){for(;;)switch(t.n){case 0:return n=r.description,a=r.photo,c=r.latitude,u=r.longitude,s=i(),(l=new FormData).append("description",n),a&&l.append("photo",a),"number"!=typeof c||isNaN(c)||l.append("lat",c.toString()),"number"!=typeof u||isNaN(u)||l.append("lon",u.toString()),t.n=1,fetch("".concat(o,"/stories"),{method:"POST",headers:{Authorization:"Bearer ".concat(s)},body:l});case 1:return f=t.v,t.n=2,f.json();case 2:if(p=t.v,f.ok){t.n=3;break}throw new Error(p.message||"Gagal tambah story");case 3:return t.a(2,p)}}),e)})))).apply(this,arguments)}function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function v(){var t,e,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var u=n&&n.prototype instanceof c?n:c,s=Object.create(u.prototype);return y(s,"_invoke",function(r,n,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:v,f:v.bind(t,4),d:function(e,r){return i=e,c=0,u=t,p.n=r,a}};function v(r,n){for(c=r,u=n,e=0;!f&&s&&!o&&e<l.length;e++){var o,i=l[e],v=p.p,y=i[2];r>3?(o=y===n)&&(c=i[4]||3,u=i[5]===t?i[3]:i[5],i[4]=3,i[5]=t):i[0]<=v&&((o=r<2&&v<i[1])?(c=0,p.v=n,p.n=i[1]):v<y&&(o=r<3||i[0]>n||n>y)&&(i[4]=r,i[5]=n,p.n=y,c=0))}if(o||r>1)return a;throw f=!0,n}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&v(l,y),c=l,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),v(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:r.call(n,p))!==a)break}catch(e){i=t,c=1,u=e}finally{s=1}}return{value:e,done:f}}}(r,o,i),!0),s}var a={};function c(){}function u(){}function s(){}e=Object.getPrototypeOf;var l=[][n]?e(e([][n]())):(y(e={},n,(function(){return this})),e),f=s.prototype=c.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,y(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=s,y(f,"constructor",s),y(s,"constructor",u),u.displayName="GeneratorFunction",y(s,o,"GeneratorFunction"),y(f),y(f,o,"Generator"),y(f,n,(function(){return this})),y(f,"toString",(function(){return"[object Generator]"})),(v=function(){return{w:i,m:p}})()}function y(t,e,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}y=function(t,e,r,n){if(e)o?o(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n}):t[e]=r;else{var i=function(e,r){y(t,e,(function(t){return this._invoke(e,r,t)}))};i("next",0),i("throw",1),i("return",2)}},y(t,e,r,n)}function d(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function h(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){d(i,n,o,a,c,"next",t)}function c(t){d(i,n,o,a,c,"throw",t)}a(void 0)}))}}function b(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,m(n.key),n)}}function m(t){var e=function(t){if("object"!=p(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=p(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==p(e)?e:e+""}var g=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"loadStories",value:(n=h(v().m((function t(){return v().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,a();case 1:return t.a(2,t.v)}}),t)}))),function(){return n.apply(this,arguments)})},{key:"addNewStory",value:(r=h(v().m((function t(e){return v().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,l(e);case 1:return t.a(2)}}),t)}))),function(t){return r.apply(this,arguments)})}],e&&b(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();const w=(t,e)=>e.some((e=>t instanceof e));let k,S;const j=new WeakMap,O=new WeakMap,P=new WeakMap;let E={get(t,e,r){if(t instanceof IDBTransaction){if("done"===e)return j.get(t);if("store"===e)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return _(t[e])},set:(t,e,r)=>(t[e]=r,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function T(t){E=t(E)}function G(t){return"function"==typeof t?(e=t,(S||(S=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(x(this),t),_(this.request)}:function(...t){return _(e.apply(x(this),t))}):(t instanceof IDBTransaction&&function(t){if(j.has(t))return;const e=new Promise(((e,r)=>{const n=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",i),t.removeEventListener("abort",i)},o=()=>{e(),n()},i=()=>{r(t.error||new DOMException("AbortError","AbortError")),n()};t.addEventListener("complete",o),t.addEventListener("error",i),t.addEventListener("abort",i)}));j.set(t,e)}(t),w(t,k||(k=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,E):t);var e}function _(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,r)=>{const n=()=>{t.removeEventListener("success",o),t.removeEventListener("error",i)},o=()=>{e(_(t.result)),n()},i=()=>{r(t.error),n()};t.addEventListener("success",o),t.addEventListener("error",i)}));return P.set(e,t),e}(t);if(O.has(t))return O.get(t);const e=G(t);return e!==t&&(O.set(t,e),P.set(e,t)),e}const x=t=>P.get(t),C=["get","getKey","getAll","getAllKeys","count"],F=["put","add","delete","clear"],B=new Map;function I(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(B.get(e))return B.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,o=F.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!o&&!C.includes(r))return;const i=async function(t,...e){const i=this.transaction(t,o?"readwrite":"readonly");let a=i.store;return n&&(a=a.index(e.shift())),(await Promise.all([a[r](...e),o&&i.done]))[0]};return B.set(e,i),i}T((t=>({...t,get:(e,r,n)=>I(e,r)||t.get(e,r,n),has:(e,r)=>!!I(e,r)||t.has(e,r)})));const A=["continue","continuePrimaryKey","advance"],D={},M=new WeakMap,N=new WeakMap,V={get(t,e){if(!A.includes(e))return t[e];let r=D[e];return r||(r=D[e]=function(...t){M.set(this,N.get(this)[e](...t))}),r}};async function*H(...t){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...t)),!e)return;const r=new Proxy(e,V);for(N.set(r,e),P.set(r,x(e));e;)yield r,e=await(M.get(r)||e.continue()),M.delete(r)}function W(t,e){return e===Symbol.asyncIterator&&w(t,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===e&&w(t,[IDBIndex,IDBObjectStore])}function U(){var t,e,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var u=n&&n.prototype instanceof c?n:c,s=Object.create(u.prototype);return q(s,"_invoke",function(r,n,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:v,f:v.bind(t,4),d:function(e,r){return i=e,c=0,u=t,p.n=r,a}};function v(r,n){for(c=r,u=n,e=0;!f&&s&&!o&&e<l.length;e++){var o,i=l[e],v=p.p,y=i[2];r>3?(o=y===n)&&(c=i[4]||3,u=i[5]===t?i[3]:i[5],i[4]=3,i[5]=t):i[0]<=v&&((o=r<2&&v<i[1])?(c=0,p.v=n,p.n=i[1]):v<y&&(o=r<3||i[0]>n||n>y)&&(i[4]=r,i[5]=n,p.n=y,c=0))}if(o||r>1)return a;throw f=!0,n}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&v(l,y),c=l,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),v(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:r.call(n,p))!==a)break}catch(e){i=t,c=1,u=e}finally{s=1}}return{value:e,done:f}}}(r,o,i),!0),s}var a={};function c(){}function u(){}function s(){}e=Object.getPrototypeOf;var l=[][n]?e(e([][n]())):(q(e={},n,(function(){return this})),e),f=s.prototype=c.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,q(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=s,q(f,"constructor",s),q(s,"constructor",u),u.displayName="GeneratorFunction",q(s,o,"GeneratorFunction"),q(f),q(f,o,"Generator"),q(f,n,(function(){return this})),q(f,"toString",(function(){return"[object Generator]"})),(U=function(){return{w:i,m:p}})()}function q(t,e,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}q=function(t,e,r,n){if(e)o?o(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n}):t[e]=r;else{var i=function(e,r){q(t,e,(function(t){return this._invoke(e,r,t)}))};i("next",0),i("throw",1),i("return",2)}},q(t,e,r,n)}function R(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}T((t=>({...t,get:(e,r,n)=>W(e,r)?H:t.get(e,r,n),has:(e,r)=>W(e,r)||t.has(e,r)})));var z="favorites",K=function(t,e,{blocked:r,upgrade:n,blocking:o,terminated:i}={}){const a=indexedDB.open(t,e),c=_(a);return n&&a.addEventListener("upgradeneeded",(t=>{n(_(a.result),t.oldVersion,t.newVersion,_(a.transaction),t)})),r&&a.addEventListener("blocked",(t=>r(t.oldVersion,t.newVersion,t))),c.then((t=>{i&&t.addEventListener("close",(()=>i())),o&&t.addEventListener("versionchange",(t=>o(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),c}("story-app",1,{upgrade:function(t){t.objectStoreNames.contains(z)||t.createObjectStore(z,{keyPath:"id"})}});function J(t){return $.apply(this,arguments)}function $(){var t;return t=U().m((function t(e){var r,n;return U().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,K;case 1:return r=t.v,t.n=2,e(r);case 2:return t.a(2,t.v);case 3:throw t.p=3,n=t.v,console.error("[idb] Error in ".concat(e.name,":"),n),n;case 4:return t.a(2)}}),t,null,[[0,3]])})),$=function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){R(i,n,o,a,c,"next",t)}function c(t){R(i,n,o,a,c,"throw",t)}a(void 0)}))},$.apply(this,arguments)}var Q=function(t){return J((function(e){return e.put(z,t)}))},Y=function(){return J((function(t){return t.getAll(z)}))},X=function(t){return J((function(e){return e.delete(z,t)}))};function Z(t){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z(t)}function tt(){var t,e,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var u=n&&n.prototype instanceof c?n:c,s=Object.create(u.prototype);return et(s,"_invoke",function(r,n,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:v,f:v.bind(t,4),d:function(e,r){return i=e,c=0,u=t,p.n=r,a}};function v(r,n){for(c=r,u=n,e=0;!f&&s&&!o&&e<l.length;e++){var o,i=l[e],v=p.p,y=i[2];r>3?(o=y===n)&&(c=i[4]||3,u=i[5]===t?i[3]:i[5],i[4]=3,i[5]=t):i[0]<=v&&((o=r<2&&v<i[1])?(c=0,p.v=n,p.n=i[1]):v<y&&(o=r<3||i[0]>n||n>y)&&(i[4]=r,i[5]=n,p.n=y,c=0))}if(o||r>1)return a;throw f=!0,n}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&v(l,y),c=l,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),v(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:r.call(n,p))!==a)break}catch(e){i=t,c=1,u=e}finally{s=1}}return{value:e,done:f}}}(r,o,i),!0),s}var a={};function c(){}function u(){}function s(){}e=Object.getPrototypeOf;var l=[][n]?e(e([][n]())):(et(e={},n,(function(){return this})),e),f=s.prototype=c.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,et(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=s,et(f,"constructor",s),et(s,"constructor",u),u.displayName="GeneratorFunction",et(s,o,"GeneratorFunction"),et(f),et(f,o,"Generator"),et(f,n,(function(){return this})),et(f,"toString",(function(){return"[object Generator]"})),(tt=function(){return{w:i,m:p}})()}function et(t,e,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}et=function(t,e,r,n){if(e)o?o(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n}):t[e]=r;else{var i=function(e,r){et(t,e,(function(t){return this._invoke(e,r,t)}))};i("next",0),i("throw",1),i("return",2)}},et(t,e,r,n)}function rt(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function nt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){rt(i,n,o,a,c,"next",t)}function c(t){rt(i,n,o,a,c,"throw",t)}a(void 0)}))}}function ot(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,it(n.key),n)}}function it(t){var e=function(t){if("object"!=Z(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Z(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Z(e)?e:e+""}var at=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.root=e},e=[{key:"clear",value:function(){this.root.innerHTML=""}},{key:"createButton",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=document.createElement("button");return n.textContent=t,r.style&&Object.assign(n.style,r.style),n.addEventListener("click",function(){var t=nt(tt().m((function t(r){var n;return tt().w((function(t){for(;;)switch(t.n){case 0:return r.stopPropagation(),t.p=1,t.n=2,e(r);case 2:t.n=4;break;case 3:t.p=3,n=t.v,alert(n.message);case 4:return t.a(2)}}),t,null,[[1,3]])})));return function(e){return t.apply(this,arguments)}}()),n}},{key:"render",value:(r=nt(tt().m((function t(e){var r,n,o,i=this;return tt().w((function(t){for(;;)switch(t.n){case 0:return this.clear(),t.n=1,Y();case 1:r=t.v,n=r.map((function(t){return t.id})),(o=document.createElement("div")).className="story-list",e.forEach((function(t){var e=document.createElement("article");e.className="story-item",e.style.cursor="pointer";var r=document.createElement("img");r.src=t.photoUrl,r.alt="Foto cerita: ".concat(t.title),r.loading="lazy";var a=document.createElement("h2");a.textContent=t.title;var c=document.createElement("p");c.textContent=t.description;var u=document.createElement("p");u.textContent=new Date(t.createdAt).toLocaleDateString();var s=document.createElement("div");if(s.style.marginTop="0.5rem","#favorites"===location.hash){var l=i.createButton("🗑 Hapus",nt(tt().m((function e(){return tt().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,X(t.id);case 1:alert("Dihapus dari favorit"),window.dispatchEvent(new Event("hashchange"));case 2:return e.a(2)}}),e)}))),{style:{marginLeft:"10px"}});s.appendChild(l)}else if(n.includes(t.id)){var f=i.createButton("✔ Favorit Disimpan",(function(){}),{style:{cursor:"default"}});f.disabled=!0,s.appendChild(f)}else{var p=i.createButton("⭐ Favorit",nt(tt().m((function e(){return tt().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Q({id:t.id,description:t.description,title:t.title,createdAt:t.createdAt,photoUrl:t.photoUrl,latitude:t.latitude,longitude:t.longitude});case 1:p.disabled=!0,p.textContent="✔ Favorit Disimpan";case 2:return e.a(2)}}),e)}))));s.appendChild(p)}e.append(r,a,c,u,s),o.appendChild(e),e.addEventListener("click",(function(){window.location.hash="#detail/".concat(t.id)}))})),this.root.appendChild(o),this.renderMap(e);case 2:return t.a(2)}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"renderMap",value:function(t){var e=document.getElementById("map");e&&e.remove();var r=document.createElement("div");r.id="map",this.root.appendChild(r);var n=L.map(r).setView([-2.5489,118.0149],5),o=L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors"}),i=L.tileLayer("https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",{attribution:"© OpenTopoMap contributors"});o.addTo(n);var a={OpenStreetMap:o,"Topo Map":i};L.control.layers(a).addTo(n),t.forEach((function(t){t.latitude&&t.longitude&&L.marker([t.latitude,t.longitude]).addTo(n).bindPopup("<strong>".concat(t.title,"</strong><br>").concat(t.description))}))}}],e&&ot(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function ct(t){return ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ct(t)}function ut(){var t,e,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var u=n&&n.prototype instanceof c?n:c,s=Object.create(u.prototype);return st(s,"_invoke",function(r,n,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:v,f:v.bind(t,4),d:function(e,r){return i=e,c=0,u=t,p.n=r,a}};function v(r,n){for(c=r,u=n,e=0;!f&&s&&!o&&e<l.length;e++){var o,i=l[e],v=p.p,y=i[2];r>3?(o=y===n)&&(c=i[4]||3,u=i[5]===t?i[3]:i[5],i[4]=3,i[5]=t):i[0]<=v&&((o=r<2&&v<i[1])?(c=0,p.v=n,p.n=i[1]):v<y&&(o=r<3||i[0]>n||n>y)&&(i[4]=r,i[5]=n,p.n=y,c=0))}if(o||r>1)return a;throw f=!0,n}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&v(l,y),c=l,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),v(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:r.call(n,p))!==a)break}catch(e){i=t,c=1,u=e}finally{s=1}}return{value:e,done:f}}}(r,o,i),!0),s}var a={};function c(){}function u(){}function s(){}e=Object.getPrototypeOf;var l=[][n]?e(e([][n]())):(st(e={},n,(function(){return this})),e),f=s.prototype=c.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,st(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=s,st(f,"constructor",s),st(s,"constructor",u),u.displayName="GeneratorFunction",st(s,o,"GeneratorFunction"),st(f),st(f,o,"Generator"),st(f,n,(function(){return this})),st(f,"toString",(function(){return"[object Generator]"})),(ut=function(){return{w:i,m:p}})()}function st(t,e,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}st=function(t,e,r,n){if(e)o?o(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n}):t[e]=r;else{var i=function(e,r){st(t,e,(function(t){return this._invoke(e,r,t)}))};i("next",0),i("throw",1),i("return",2)}},st(t,e,r,n)}function lt(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function ft(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){lt(i,n,o,a,c,"next",t)}function c(t){lt(i,n,o,a,c,"throw",t)}a(void 0)}))}}function pt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vt(n.key),n)}}function vt(t){var e=function(t){if("object"!=ct(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ct(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ct(e)?e:e+""}var yt=function(){return t=function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.root=e,this.onAddStory=r,this.latitude=null,this.longitude=null,this.stream=null,this.video=null,this.photoBlob=null,this.marker=null,this.map=null,this.photoPreview=null},e=[{key:"clear",value:function(){this.stopCamera(),this.root.innerHTML=""}},{key:"render",value:function(){var t=this;this.clear();var e=document.createElement("form");e.setAttribute("aria-label","Form tambah story");var r=this.createLabel("desc-input","Deskripsi"),n=this.createTextarea("desc-input","description",!0),o=document.createElement("label");o.textContent="Ambil Foto",this.video=document.createElement("video"),this.video.autoplay=!0,this.video.playsInline=!0,this.video.style.width="100%",this.video.style.borderRadius="10px";var i=document.createElement("button");i.type="button",i.innerHTML='<i class="fas fa-camera"></i> Ambil Foto',i.addEventListener("click",(function(){return t.capturePhoto()})),this.photoPreview=document.createElement("img"),this.photoPreview.alt="Preview foto yang diambil",this.photoPreview.style.width="100%",this.photoPreview.style.borderRadius="10px",this.photoPreview.style.display="none";var a=document.createElement("label");a.textContent="Pilih Lokasi (klik pada peta)";var c=document.createElement("div");c.id="add-map";var u=document.createElement("button");u.type="submit",u.textContent="Tambah Story",e.append(r,n,o,this.video,i,this.photoPreview,a,c,u),this.root.appendChild(e),this.initCamera(),this.initMap(),e.addEventListener("submit",function(){var e=ft(ut().m((function e(r){var o,i;return ut().w((function(e){for(;;)switch(e.n){case 0:if(r.preventDefault(),t.photoBlob){e.n=1;break}return alert("Harap ambil foto terlebih dahulu."),e.a(2);case 1:if(null!==t.latitude&&null!==t.longitude){e.n=2;break}return alert("Harap pilih lokasi di peta."),e.a(2);case 2:return o=n.value.trim(),e.p=3,e.n=4,t.onAddStory({description:o,photo:t.photoBlob,latitude:t.latitude,longitude:t.longitude});case 4:alert("Story berhasil ditambahkan!"),t.clear(),window.location.hash="#list",e.n=6;break;case 5:e.p=5,i=e.v,alert("Gagal menambahkan story: "+i.message);case 6:return e.a(2)}}),e,null,[[3,5]])})));return function(t){return e.apply(this,arguments)}}())}},{key:"createLabel",value:function(t,e){var r=document.createElement("label");return r.setAttribute("for",t),r.textContent=e,r}},{key:"createTextarea",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=document.createElement("textarea");return n.id=t,n.name=e,n.required=r,n}},{key:"initCamera",value:(r=ft(ut().m((function t(){var e;return ut().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,navigator.mediaDevices.getUserMedia({video:!0});case 1:this.stream=t.v,this.video.srcObject=this.stream,t.n=3;break;case 2:t.p=2,e=t.v,alert("Tidak dapat mengakses kamera: "+e.message);case 3:return t.a(2)}}),t,this,[[0,2]])}))),function(){return r.apply(this,arguments)})},{key:"stopCamera",value:function(){this.stream&&(this.stream.getTracks().forEach((function(t){return t.stop()})),this.stream=null)}},{key:"capturePhoto",value:function(){var t=this;if(this.video){var e=document.createElement("canvas");e.width=this.video.videoWidth,e.height=this.video.videoHeight,e.getContext("2d").drawImage(this.video,0,0),e.toBlob((function(e){e?(t.photoBlob=e,t.photoPreview.src=URL.createObjectURL(e),t.photoPreview.style.display="block",t.stopCamera()):alert("Gagal mengambil foto.")}),"image/jpeg")}}},{key:"initMap",value:function(){var t=this,e=document.getElementById("add-map");this.map=L.map(e).setView([-2.5489,118.0149],5);var r=L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors"}),n=L.tileLayer("https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",{attribution:"© OpenTopoMap contributors"});r.addTo(this.map),L.control.layers({OpenStreetMap:r,"Topo Map":n}).addTo(this.map),this.marker=null,this.map.on("click",(function(e){var r=e.latlng,n=r.lat,o=r.lng;t.latitude=n,t.longitude=o,t.marker?t.marker.setLatLng(e.latlng):t.marker=L.marker(e.latlng).addTo(t.map)}))}}],e&&pt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function dt(){var t,e,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var u=n&&n.prototype instanceof c?n:c,s=Object.create(u.prototype);return ht(s,"_invoke",function(r,n,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:v,f:v.bind(t,4),d:function(e,r){return i=e,c=0,u=t,p.n=r,a}};function v(r,n){for(c=r,u=n,e=0;!f&&s&&!o&&e<l.length;e++){var o,i=l[e],v=p.p,y=i[2];r>3?(o=y===n)&&(c=i[4]||3,u=i[5]===t?i[3]:i[5],i[4]=3,i[5]=t):i[0]<=v&&((o=r<2&&v<i[1])?(c=0,p.v=n,p.n=i[1]):v<y&&(o=r<3||i[0]>n||n>y)&&(i[4]=r,i[5]=n,p.n=y,c=0))}if(o||r>1)return a;throw f=!0,n}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&v(l,y),c=l,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),v(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:r.call(n,p))!==a)break}catch(e){i=t,c=1,u=e}finally{s=1}}return{value:e,done:f}}}(r,o,i),!0),s}var a={};function c(){}function u(){}function s(){}e=Object.getPrototypeOf;var l=[][n]?e(e([][n]())):(ht(e={},n,(function(){return this})),e),f=s.prototype=c.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,ht(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=s,ht(f,"constructor",s),ht(s,"constructor",u),u.displayName="GeneratorFunction",ht(s,o,"GeneratorFunction"),ht(f),ht(f,o,"Generator"),ht(f,n,(function(){return this})),ht(f,"toString",(function(){return"[object Generator]"})),(dt=function(){return{w:i,m:p}})()}function ht(t,e,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}ht=function(t,e,r,n){if(e)o?o(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n}):t[e]=r;else{var i=function(e,r){ht(t,e,(function(t){return this._invoke(e,r,t)}))};i("next",0),i("throw",1),i("return",2)}},ht(t,e,r,n)}function bt(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function mt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){bt(i,n,o,a,c,"next",t)}function c(t){bt(i,n,o,a,c,"throw",t)}a(void 0)}))}}var gt="https://story-api.dicoding.dev/v1";function wt(t,e,r){return kt.apply(this,arguments)}function kt(){return(kt=mt(dt().m((function t(e,r,n){var o,i;return dt().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,fetch("".concat(gt,"/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:r,password:n})});case 1:return o=t.v,t.n=2,o.json();case 2:if(i=t.v,o.ok&&!i.error){t.n=3;break}throw new Error(i.message||"Registrasi gagal");case 3:return t.a(2,i)}}),t)})))).apply(this,arguments)}function St(t,e){return jt.apply(this,arguments)}function jt(){return(jt=mt(dt().m((function t(e,r){var n,o;return dt().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,fetch("".concat(gt,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:r})});case 1:return n=t.v,t.n=2,n.json();case 2:if(o=t.v,n.ok&&!o.error){t.n=3;break}throw new Error(o.message||"Login gagal");case 3:return localStorage.setItem("token",o.loginResult.token),localStorage.setItem("userName",o.loginResult.name),t.a(2,o.loginResult)}}),t)})))).apply(this,arguments)}function Ot(t){return Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ot(t)}function Pt(){var t,e,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var u=n&&n.prototype instanceof c?n:c,s=Object.create(u.prototype);return Et(s,"_invoke",function(r,n,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:v,f:v.bind(t,4),d:function(e,r){return i=e,c=0,u=t,p.n=r,a}};function v(r,n){for(c=r,u=n,e=0;!f&&s&&!o&&e<l.length;e++){var o,i=l[e],v=p.p,y=i[2];r>3?(o=y===n)&&(c=i[4]||3,u=i[5]===t?i[3]:i[5],i[4]=3,i[5]=t):i[0]<=v&&((o=r<2&&v<i[1])?(c=0,p.v=n,p.n=i[1]):v<y&&(o=r<3||i[0]>n||n>y)&&(i[4]=r,i[5]=n,p.n=y,c=0))}if(o||r>1)return a;throw f=!0,n}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&v(l,y),c=l,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),v(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:r.call(n,p))!==a)break}catch(e){i=t,c=1,u=e}finally{s=1}}return{value:e,done:f}}}(r,o,i),!0),s}var a={};function c(){}function u(){}function s(){}e=Object.getPrototypeOf;var l=[][n]?e(e([][n]())):(Et(e={},n,(function(){return this})),e),f=s.prototype=c.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,Et(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=s,Et(f,"constructor",s),Et(s,"constructor",u),u.displayName="GeneratorFunction",Et(s,o,"GeneratorFunction"),Et(f),Et(f,o,"Generator"),Et(f,n,(function(){return this})),Et(f,"toString",(function(){return"[object Generator]"})),(Pt=function(){return{w:i,m:p}})()}function Et(t,e,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Et=function(t,e,r,n){if(e)o?o(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n}):t[e]=r;else{var i=function(e,r){Et(t,e,(function(t){return this._invoke(e,r,t)}))};i("next",0),i("throw",1),i("return",2)}},Et(t,e,r,n)}function Tt(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function Gt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_t(n.key),n)}}function _t(t){var e=function(t){if("object"!=Ot(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ot(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ot(e)?e:e+""}var Lt=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.root=e},e=[{key:"clear",value:function(){this.root.innerHTML=""}},{key:"render",value:function(){this.clear();var t=document.createElement("form");t.innerHTML='\n      <h2>Daftar</h2>\n      <label for="name">Nama</label>\n      <input id="name" type="text" required />\n      <label for="email">Email</label>\n      <input id="email" type="email" required />\n      <label for="password">Password</label>\n      <input id="password" type="password" required minlength="8" />\n      <button type="submit">Register</button>\n      <p>Sudah punya akun? <a href="#login">Login di sini</a></p>\n    ',t.addEventListener("submit",function(){var e,r=(e=Pt().m((function e(r){var n,o,i,a;return Pt().w((function(e){for(;;)switch(e.n){case 0:return r.preventDefault(),n=t.querySelector("#name").value,o=t.querySelector("#email").value,i=t.querySelector("#password").value,e.p=1,e.n=2,wt(n,o,i);case 2:alert("Registrasi berhasil! Silakan login."),location.hash="#login",e.n=4;break;case 3:e.p=3,a=e.v,alert("Registrasi gagal: "+a.message);case 4:return e.a(2)}}),e,null,[[1,3]])})),function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(t){Tt(i,n,o,a,c,"next",t)}function c(t){Tt(i,n,o,a,c,"throw",t)}a(void 0)}))});return function(t){return r.apply(this,arguments)}}()),this.root.appendChild(t)}}],e&&Gt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function xt(t){return xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xt(t)}function Ct(){var t,e,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var u=n&&n.prototype instanceof c?n:c,s=Object.create(u.prototype);return Ft(s,"_invoke",function(r,n,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:v,f:v.bind(t,4),d:function(e,r){return i=e,c=0,u=t,p.n=r,a}};function v(r,n){for(c=r,u=n,e=0;!f&&s&&!o&&e<l.length;e++){var o,i=l[e],v=p.p,y=i[2];r>3?(o=y===n)&&(c=i[4]||3,u=i[5]===t?i[3]:i[5],i[4]=3,i[5]=t):i[0]<=v&&((o=r<2&&v<i[1])?(c=0,p.v=n,p.n=i[1]):v<y&&(o=r<3||i[0]>n||n>y)&&(i[4]=r,i[5]=n,p.n=y,c=0))}if(o||r>1)return a;throw f=!0,n}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&v(l,y),c=l,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),v(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:r.call(n,p))!==a)break}catch(e){i=t,c=1,u=e}finally{s=1}}return{value:e,done:f}}}(r,o,i),!0),s}var a={};function c(){}function u(){}function s(){}e=Object.getPrototypeOf;var l=[][n]?e(e([][n]())):(Ft(e={},n,(function(){return this})),e),f=s.prototype=c.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,Ft(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=s,Ft(f,"constructor",s),Ft(s,"constructor",u),u.displayName="GeneratorFunction",Ft(s,o,"GeneratorFunction"),Ft(f),Ft(f,o,"Generator"),Ft(f,n,(function(){return this})),Ft(f,"toString",(function(){return"[object Generator]"})),(Ct=function(){return{w:i,m:p}})()}function Ft(t,e,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Ft=function(t,e,r,n){if(e)o?o(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n}):t[e]=r;else{var i=function(e,r){Ft(t,e,(function(t){return this._invoke(e,r,t)}))};i("next",0),i("throw",1),i("return",2)}},Ft(t,e,r,n)}function Bt(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function It(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,At(n.key),n)}}function At(t){var e=function(t){if("object"!=xt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=xt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==xt(e)?e:e+""}var Dt=function(){return t=function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.root=e,this.onLoginSuccess=r},e=[{key:"clear",value:function(){this.root.innerHTML=""}},{key:"render",value:function(){var t=this;this.clear();var e=document.createElement("form");e.innerHTML='\n      <h2>Login</h2>\n      <label for="email">Email</label>\n      <input id="email" type="email" required />\n      <label for="password">Password</label>\n      <input id="password" type="password" required />\n      <button type="submit">Login</button>\n      <p>Belum punya akun? <a href="#register">Daftar di sini</a></p>\n    ',e.addEventListener("submit",function(){var r,n=(r=Ct().m((function r(n){var o,i,a,c;return Ct().w((function(r){for(;;)switch(r.n){case 0:return n.preventDefault(),o=e.querySelector("#email").value,i=e.querySelector("#password").value,r.p=1,r.n=2,St(o,i);case 2:a=r.v,alert("Selamat datang, ".concat(a.name,"!")),t.onLoginSuccess(),location.hash="#list",r.n=4;break;case 3:r.p=3,c=r.v,alert("Login gagal: "+c.message);case 4:return r.a(2)}}),r,null,[[1,3]])})),function(){var t=this,e=arguments;return new Promise((function(n,o){var i=r.apply(t,e);function a(t){Bt(i,n,o,a,c,"next",t)}function c(t){Bt(i,n,o,a,c,"throw",t)}a(void 0)}))});return function(t){return n.apply(this,arguments)}}()),this.root.appendChild(e)}}],e&&It(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Mt(t){return Mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mt(t)}function Nt(){var t,e,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var u=n&&n.prototype instanceof c?n:c,s=Object.create(u.prototype);return Vt(s,"_invoke",function(r,n,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:v,f:v.bind(t,4),d:function(e,r){return i=e,c=0,u=t,p.n=r,a}};function v(r,n){for(c=r,u=n,e=0;!f&&s&&!o&&e<l.length;e++){var o,i=l[e],v=p.p,y=i[2];r>3?(o=y===n)&&(c=i[4]||3,u=i[5]===t?i[3]:i[5],i[4]=3,i[5]=t):i[0]<=v&&((o=r<2&&v<i[1])?(c=0,p.v=n,p.n=i[1]):v<y&&(o=r<3||i[0]>n||n>y)&&(i[4]=r,i[5]=n,p.n=y,c=0))}if(o||r>1)return a;throw f=!0,n}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&v(l,y),c=l,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),v(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:r.call(n,p))!==a)break}catch(e){i=t,c=1,u=e}finally{s=1}}return{value:e,done:f}}}(r,o,i),!0),s}var a={};function c(){}function u(){}function s(){}e=Object.getPrototypeOf;var l=[][n]?e(e([][n]())):(Vt(e={},n,(function(){return this})),e),f=s.prototype=c.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,Vt(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=s,Vt(f,"constructor",s),Vt(s,"constructor",u),u.displayName="GeneratorFunction",Vt(s,o,"GeneratorFunction"),Vt(f),Vt(f,o,"Generator"),Vt(f,n,(function(){return this})),Vt(f,"toString",(function(){return"[object Generator]"})),(Nt=function(){return{w:i,m:p}})()}function Vt(t,e,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Vt=function(t,e,r,n){if(e)o?o(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n}):t[e]=r;else{var i=function(e,r){Vt(t,e,(function(t){return this._invoke(e,r,t)}))};i("next",0),i("throw",1),i("return",2)}},Vt(t,e,r,n)}function Ht(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function Wt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ut(n.key),n)}}function Ut(t){var e=function(t){if("object"!=Mt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Mt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Mt(e)?e:e+""}var qt=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.root=e},e=[{key:"clear",value:function(){this.root.innerHTML=""}},{key:"render",value:(r=Nt().m((function t(e){var r,n,o,i;return Nt().w((function(t){for(;;)switch(t.n){case 0:return this.clear(),t.p=1,t.n=2,u(e);case 2:r=t.v,(n=document.createElement("div")).innerHTML="\n        <h2>".concat(r.name,'</h2>\n        <img src="').concat(r.photoUrl,'" alt="Foto oleh ').concat(r.name,'" style="width:100%;border-radius:10px;" />\n        <p>').concat(r.description,"</p>\n        <small>Dibuat pada: ").concat(new Date(r.createdAt).toLocaleString(),'</small>\n        <div id="map-detail" style="height: 300px; margin-top: 1rem;"></div>\n      '),this.root.appendChild(n),r.lat&&r.lon&&(o=L.map("map-detail").setView([r.lat,r.lon],13),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap"}).addTo(o),L.marker([r.lat,r.lon]).addTo(o).bindPopup("Lokasi story").openPopup()),t.n=4;break;case 3:t.p=3,i=t.v,this.root.innerHTML='<p style="color:red">Gagal mengambil detail: '.concat(i.message,"</p>");case 4:return t.a(2)}}),t,this,[[1,3]])})),n=function(){var t=this,e=arguments;return new Promise((function(n,o){var i=r.apply(t,e);function a(t){Ht(i,n,o,a,c,"next",t)}function c(t){Ht(i,n,o,a,c,"throw",t)}a(void 0)}))},function(t){return n.apply(this,arguments)})}],e&&Wt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function Rt(t){return Rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rt(t)}function zt(){var t,e,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var u=n&&n.prototype instanceof c?n:c,s=Object.create(u.prototype);return Kt(s,"_invoke",function(r,n,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:v,f:v.bind(t,4),d:function(e,r){return i=e,c=0,u=t,p.n=r,a}};function v(r,n){for(c=r,u=n,e=0;!f&&s&&!o&&e<l.length;e++){var o,i=l[e],v=p.p,y=i[2];r>3?(o=y===n)&&(c=i[4]||3,u=i[5]===t?i[3]:i[5],i[4]=3,i[5]=t):i[0]<=v&&((o=r<2&&v<i[1])?(c=0,p.v=n,p.n=i[1]):v<y&&(o=r<3||i[0]>n||n>y)&&(i[4]=r,i[5]=n,p.n=y,c=0))}if(o||r>1)return a;throw f=!0,n}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&v(l,y),c=l,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),v(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:r.call(n,p))!==a)break}catch(e){i=t,c=1,u=e}finally{s=1}}return{value:e,done:f}}}(r,o,i),!0),s}var a={};function c(){}function u(){}function s(){}e=Object.getPrototypeOf;var l=[][n]?e(e([][n]())):(Kt(e={},n,(function(){return this})),e),f=s.prototype=c.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,Kt(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=s,Kt(f,"constructor",s),Kt(s,"constructor",u),u.displayName="GeneratorFunction",Kt(s,o,"GeneratorFunction"),Kt(f),Kt(f,o,"Generator"),Kt(f,n,(function(){return this})),Kt(f,"toString",(function(){return"[object Generator]"})),(zt=function(){return{w:i,m:p}})()}function Kt(t,e,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Kt=function(t,e,r,n){if(e)o?o(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n}):t[e]=r;else{var i=function(e,r){Kt(t,e,(function(t){return this._invoke(e,r,t)}))};i("next",0),i("throw",1),i("return",2)}},Kt(t,e,r,n)}function Jt(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function $t(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Jt(i,n,o,a,c,"next",t)}function c(t){Jt(i,n,o,a,c,"throw",t)}a(void 0)}))}}function Qt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Yt(n.key),n)}}function Yt(t){var e=function(t){if("object"!=Rt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Rt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Rt(e)?e:e+""}var Xt=function(){return t=function t(e){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.root=e,this.model=new g,this.views={list:new at(e),add:new yt(e,(function(t){return r.handleAddStory(t)})),register:new Lt(e),login:new Dt(e,(function(){return r.handleRoute()})),detail:new qt(e)},this.currentView=null,window.addEventListener("hashchange",(function(){return r.handleRoute()}))},e=[{key:"init",value:(a=$t(zt().m((function t(){return zt().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,this.handleRoute();case 1:return t.a(2)}}),t,this)}))),function(){return a.apply(this,arguments)})},{key:"getCurrentHash",value:function(){return location.hash.trim()||"#list"}},{key:"clearCurrentView",value:function(){var t;null!==(t=this.currentView)&&void 0!==t&&t.clear&&this.currentView.clear()}},{key:"handleRoute",value:(i=$t(zt().m((function t(){var e,r,n,o,i,a=this;return zt().w((function(t){for(;;)switch(t.n){case 0:if(e=this.getCurrentHash(),r={"#list":this.renderList.bind(this),"#add":function(){return a.switchView("add")},"#register":function(){return a.switchView("register")},"#login":function(){return a.switchView("login")},"#favorites":this.renderFavorites.bind(this)},n=e.startsWith("#detail/"),o=function(){var t=$t(zt().m((function t(){var o,i;return zt().w((function(t){for(;;)switch(t.n){case 0:if(a.clearCurrentView(),!r[e]){t.n=2;break}return t.n=1,r[e]();case 1:t.n=5;break;case 2:if(!n){t.n=4;break}if(i=e.split("/")[1]){t.n=3;break}throw new Error("ID tidak valid");case 3:a.switchView("detail",i),t.n=5;break;case 4:a.renderNotFound();case 5:null===(o=a.root.querySelector("#main-content"))||void 0===o||o.focus();case 6:return t.a(2)}}),t)})));return function(){return t.apply(this,arguments)}}(),t.p=1,!document.startViewTransition){t.n=3;break}return t.n=2,document.startViewTransition(o);case 2:t.n=4;break;case 3:return t.n=4,o();case 4:t.n=6;break;case 5:t.p=5,i=t.v,this.renderError(i);case 6:return t.a(2)}}),t,this,[[1,5]])}))),function(){return i.apply(this,arguments)})},{key:"renderList",value:(o=$t(zt().m((function t(){var e,r;return zt().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,this.model.loadStories();case 1:e=t.v,this.switchView("list",e),t.n=3;break;case 2:t.p=2,r=t.v,console.warn("Gagal ambil data dari API:",r.message),this.switchView("list",[]);case 3:return t.a(2)}}),t,this,[[0,2]])}))),function(){return o.apply(this,arguments)})},{key:"renderFavorites",value:(n=$t(zt().m((function t(){var e,r;return zt().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,Y();case 1:e=t.v,this.switchView("list",e),t.n=3;break;case 2:t.p=2,r=t.v,console.warn("Gagal ambil data favorit:",r.message),this.switchView("list",[]);case 3:return t.a(2)}}),t,this,[[0,2]])}))),function(){return n.apply(this,arguments)})},{key:"switchView",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t){case"list":this.views.list.render(e||[]),this.currentView=this.views.list;break;case"add":this.views.add.render(),this.currentView=this.views.add;break;case"register":this.views.register.render(),this.currentView=this.views.register;break;case"login":this.views.login.render(),this.currentView=this.views.login;break;case"detail":this.views.detail.render(e),this.currentView=this.views.detail;break;default:this.renderNotFound()}}},{key:"renderNotFound",value:function(){this.root.innerHTML='\n      <main id="main-content" tabindex="-1">\n        <h2>404 - Halaman tidak ditemukan</h2>\n        <p>Halaman yang kamu cari tidak tersedia.</p>\n      </main>\n    '}},{key:"renderError",value:function(t){console.error("Terjadi kesalahan saat merender view:",t),this.root.innerHTML='<p style="color:red;">Terjadi kesalahan: '.concat(t.message,"</p>")}},{key:"handleAddStory",value:(r=$t(zt().m((function t(e){var r;return zt().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,this.model.addNewStory(e);case 1:location.hash="#list",t.n=3;break;case 2:t.p=2,r=t.v,console.error("Gagal menambah story:",r.message),alert("Gagal menambah story: ".concat(r.message));case 3:return t.a(2)}}),t,this,[[0,2]])}))),function(t){return r.apply(this,arguments)})}],e&&Qt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a}();function Zt(){var t,e,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var u=n&&n.prototype instanceof c?n:c,s=Object.create(u.prototype);return te(s,"_invoke",function(r,n,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:v,f:v.bind(t,4),d:function(e,r){return i=e,c=0,u=t,p.n=r,a}};function v(r,n){for(c=r,u=n,e=0;!f&&s&&!o&&e<l.length;e++){var o,i=l[e],v=p.p,y=i[2];r>3?(o=y===n)&&(c=i[4]||3,u=i[5]===t?i[3]:i[5],i[4]=3,i[5]=t):i[0]<=v&&((o=r<2&&v<i[1])?(c=0,p.v=n,p.n=i[1]):v<y&&(o=r<3||i[0]>n||n>y)&&(i[4]=r,i[5]=n,p.n=y,c=0))}if(o||r>1)return a;throw f=!0,n}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&v(l,y),c=l,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),v(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:r.call(n,p))!==a)break}catch(e){i=t,c=1,u=e}finally{s=1}}return{value:e,done:f}}}(r,o,i),!0),s}var a={};function c(){}function u(){}function s(){}e=Object.getPrototypeOf;var l=[][n]?e(e([][n]())):(te(e={},n,(function(){return this})),e),f=s.prototype=c.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,te(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=s,te(f,"constructor",s),te(s,"constructor",u),u.displayName="GeneratorFunction",te(s,o,"GeneratorFunction"),te(f),te(f,o,"Generator"),te(f,n,(function(){return this})),te(f,"toString",(function(){return"[object Generator]"})),(Zt=function(){return{w:i,m:p}})()}function te(t,e,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}te=function(t,e,r,n){if(e)o?o(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n}):t[e]=r;else{var i=function(e,r){te(t,e,(function(t){return this._invoke(e,r,t)}))};i("next",0),i("throw",1),i("return",2)}},te(t,e,r,n)}function ee(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function re(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ee(i,n,o,a,c,"next",t)}function c(t){ee(i,n,o,a,c,"throw",t)}a(void 0)}))}}function ne(t){return function(t){if(Array.isArray(t))return oe(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return oe(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?oe(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oe(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var ie="https://story-api.dicoding.dev/v1";function ae(){var t=localStorage.getItem("token");if(!t)throw new Error("User belum login");return t}function ce(t){return btoa(String.fromCharCode.apply(String,ne(new Uint8Array(t))))}function ue(){return se.apply(this,arguments)}function se(){return(se=re(Zt().m((function t(){var e,r,n,o,i,a;return Zt().w((function(t){for(;;)switch(t.n){case 0:if(e=ae(),"serviceWorker"in navigator){t.n=1;break}throw new Error("ServiceWorker not supported");case 1:return t.n=2,navigator.serviceWorker.ready;case 2:return r=t.v,t.n=3,r.pushManager.getSubscription();case 3:if(n=t.v){t.n=5;break}return t.n=4,r.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:(c="BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk",void 0,void 0,u=(c+"=".repeat(1)).replace(/-/g,"+").replace(/_/g,"/"),s=atob(u),new Uint8Array(ne(s).map((function(t){return t.charCodeAt(0)}))))});case 4:n=t.v;case 5:return o={endpoint:n.endpoint,keys:{p256dh:ce(n.getKey("p256dh")),auth:ce(n.getKey("auth"))}},t.n=6,fetch("".concat(ie,"/notifications/subscribe"),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(o)});case 6:if((i=t.v).ok){t.n=8;break}return t.n=7,i.json();case 7:throw a=t.v,new Error(a.message||"Gagal subscribe push notification");case 8:return t.a(2,i.json())}var c,u,s}),t)})))).apply(this,arguments)}function le(){return fe.apply(this,arguments)}function fe(){return(fe=re(Zt().m((function t(){var e,r,n,o,i;return Zt().w((function(t){for(;;)switch(t.n){case 0:if(e=ae(),"serviceWorker"in navigator){t.n=1;break}throw new Error("ServiceWorker not supported");case 1:return t.n=2,navigator.serviceWorker.ready;case 2:return r=t.v,t.n=3,r.pushManager.getSubscription();case 3:if(n=t.v){t.n=4;break}throw new Error("Belum ada subscription");case 4:return t.n=5,fetch("".concat(ie,"/notifications/subscribe"),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({endpoint:n.endpoint})});case 5:if((o=t.v).ok){t.n=7;break}return t.n=6,o.json();case 6:throw i=t.v,new Error(i.message||"Gagal unsubscribe push notification");case 7:return t.n=8,n.unsubscribe();case 8:return t.a(2,o.json())}}),t)})))).apply(this,arguments)}function pe(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function ve(){var t,e,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var u=n&&n.prototype instanceof c?n:c,s=Object.create(u.prototype);return ye(s,"_invoke",function(r,n,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:v,f:v.bind(t,4),d:function(e,r){return i=e,c=0,u=t,p.n=r,a}};function v(r,n){for(c=r,u=n,e=0;!f&&s&&!o&&e<l.length;e++){var o,i=l[e],v=p.p,y=i[2];r>3?(o=y===n)&&(c=i[4]||3,u=i[5]===t?i[3]:i[5],i[4]=3,i[5]=t):i[0]<=v&&((o=r<2&&v<i[1])?(c=0,p.v=n,p.n=i[1]):v<y&&(o=r<3||i[0]>n||n>y)&&(i[4]=r,i[5]=n,p.n=y,c=0))}if(o||r>1)return a;throw f=!0,n}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&v(l,y),c=l,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),v(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:r.call(n,p))!==a)break}catch(e){i=t,c=1,u=e}finally{s=1}}return{value:e,done:f}}}(r,o,i),!0),s}var a={};function c(){}function u(){}function s(){}e=Object.getPrototypeOf;var l=[][n]?e(e([][n]())):(ye(e={},n,(function(){return this})),e),f=s.prototype=c.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,ye(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=s,ye(f,"constructor",s),ye(s,"constructor",u),u.displayName="GeneratorFunction",ye(s,o,"GeneratorFunction"),ye(f),ye(f,o,"Generator"),ye(f,n,(function(){return this})),ye(f,"toString",(function(){return"[object Generator]"})),(ve=function(){return{w:i,m:p}})()}function ye(t,e,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}ye=function(t,e,r,n){if(e)o?o(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n}):t[e]=r;else{var i=function(e,r){ye(t,e,(function(t){return this._invoke(e,r,t)}))};i("next",0),i("throw",1),i("return",2)}},ye(t,e,r,n)}function de(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function he(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){de(i,n,o,a,c,"next",t)}function c(t){de(i,n,o,a,c,"throw",t)}a(void 0)}))}}function be(){return me.apply(this,arguments)}function me(){return(me=he(ve().m((function t(){var e;return ve().w((function(t){for(;;)switch(t.n){case 0:if("serviceWorker"in navigator){t.n=1;break}return t.a(2);case 1:return t.p=1,t.n=2,navigator.serviceWorker.register("sw.js");case 2:return t.n=3,navigator.serviceWorker.ready;case 3:console.log("✅ Service worker registered"),t.n=5;break;case 4:t.p=4,e=t.v,console.warn("SW registration failed:",e.message);case 5:return t.a(2)}}),t,null,[[1,4]])})))).apply(this,arguments)}function ge(){var t=document.getElementById("btn-subscribe"),e=document.getElementById("btn-unsubscribe");if(t&&e){var r=localStorage.getItem("token");if(!r)return t.style.display="none",void(e.style.display="none");t.addEventListener("click",he(ve().m((function n(){var o,i,a;return ve().w((function(n){for(;;)switch(n.n){case 0:return n.p=0,n.n=1,navigator.serviceWorker.ready;case 1:return o=n.v,n.n=2,o.pushManager.getSubscription();case 2:if(!n.v){n.n=3;break}return alert("Sudah aktif"),n.a(2);case 3:return n.n=4,o.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:(u="BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk",void 0,void 0,void 0,s="=".repeat(1),l=(u+s).replace(/-/g,"+").replace(/_/g,"/"),f=atob(l),new Uint8Array((c=f,function(t){if(Array.isArray(t))return pe(t)}(c)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(c)||function(t,e){if(t){if("string"==typeof t)return pe(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?pe(t,e):void 0}}(c)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).map((function(t){return t.charCodeAt(0)}))))});case 4:return i=n.v,n.n=5,ue(i,r);case 5:t.style.display="none",e.style.display="inline-block",alert("Notifikasi berhasil diaktifkan!"),n.n=7;break;case 6:n.p=6,a=n.v,alert("Gagal subscribe: "+a.message);case 7:return n.a(2)}var c,u,s,l,f}),n,null,[[0,6]])})))),e.addEventListener("click",he(ve().m((function n(){var o,i,a;return ve().w((function(n){for(;;)switch(n.n){case 0:return n.p=0,n.n=1,navigator.serviceWorker.ready;case 1:return o=n.v,n.n=2,o.pushManager.getSubscription();case 2:if(i=n.v){n.n=3;break}return alert("Belum berlangganan"),n.a(2);case 3:return n.n=4,le(i,r);case 4:return n.n=5,i.unsubscribe();case 5:t.style.display="inline-block",e.style.display="none",alert("Notifikasi berhasil dinonaktifkan."),n.n=7;break;case 6:n.p=6,a=n.v,alert("Gagal unsubscribe: "+a.message);case 7:return n.a(2)}}),n,null,[[0,6]])}))))}}document.addEventListener("DOMContentLoaded",he(ve().m((function t(){var e;return ve().w((function(t){for(;;)switch(t.n){case 0:return e=document.getElementById("main-content"),new Xt(e).init(),t.n=1,be();case 1:ge();case 2:return t.a(2)}}),t)}))))})();